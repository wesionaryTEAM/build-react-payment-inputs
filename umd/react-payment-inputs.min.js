!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],r):r((e=e||self).ReactPaymentInputs={},e.React)}(this,function(e,r){"use strict";function t(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function n(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(r){t(e,r,n[r])})}return e}function a(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function o(e,r){return i(e)||function(e,r){var t=[],n=!0,a=!1,o=void 0;try{for(var u,i=e[Symbol.iterator]();!(n=(u=i.next()).done)&&(t.push(u.value),!r||t.length!==r);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return t}(e,r)||c()}function u(e){return i(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||c()}function i(e){if(Array.isArray(e))return e}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}r=r&&r.hasOwnProperty("default")?r.default:r;var l=/(\d{1,4})/g,s=[{displayName:"Visa",type:"visa",format:l,startPattern:/^4/,gaps:[4,8,12],lengths:[16,18,19],code:{name:"CVV",length:3}},{displayName:"Mastercard",type:"mastercard",format:l,startPattern:/^(5[1-5]|677189)|^(222[1-9]|2[3-6]\d{2}|27[0-1]\d|2720)/,gaps:[4,8,12],lengths:[16],code:{name:"CVC",length:3}},{displayName:"American Express",type:"amex",format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,startPattern:/^3[47]/,gaps:[4,10],lengths:[15],code:{name:"CID",length:4}},{displayName:"Diners Club",type:"dinersclub",format:l,startPattern:/^(36|38|30[0-5])/,gaps:[4,10],lengths:[14,16,19],code:{name:"CVV",length:3}},{displayName:"Discover",type:"discover",format:l,startPattern:/^(6011|65|64[4-9]|622)/,gaps:[4,8,12],lengths:[16,19],code:{name:"CID",length:3}},{displayName:"JCB",type:"jcb",format:l,startPattern:/^35/,gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVV",length:3}},{displayName:"UnionPay",type:"unionpay",format:l,startPattern:/^62/,gaps:[4,8,12],lengths:[14,15,16,17,18,19],code:{name:"CVN",length:3}},{displayName:"Maestro",type:"maestro",format:l,startPattern:/^(5018|5020|5038|6304|6703|6708|6759|676[1-3])/,gaps:[4,8,12],lengths:[12,13,14,15,16,17,18,19],code:{name:"CVC",length:3}},{displayName:"Elo",type:"elo",format:l,startPattern:/^(4011(78|79)|43(1274|8935)|45(1416|7393|763(1|2))|50(4175|6699|67[0-7][0-9]|9000)|627780|63(6297|6368)|650(03([^4])|04([0-9])|05(0|1)|4(0[5-9]|3[0-9]|8[5-9]|9[0-9])|5([0-2][0-9]|3[0-8])|9([2-6][0-9]|7[0-8])|541|700|720|901)|651652|655000|655021)/,gaps:[4,8,12],lengths:[16],code:{name:"CVE",length:3}},{displayName:"Hipercard",type:"hipercard",format:l,startPattern:/^(384100|384140|384160|606282|637095|637568|60(?!11))/,gaps:[4,8,12],lengths:[16],code:{name:"CVC",length:3}}],d=function(e){return s.filter(function(r){return r.startPattern.test(e)})[0]},f=/(0[1-9]|1[0-2])/,v=function(e){return e.split("").reverse().map(function(e){return parseInt(e,10)}).map(function(e,r){return r%2?2*e:e}).map(function(e){return e>9?e%10+1:e}).reduce(function(e,r){return e+r})%10==0},p=function(e,r){var t=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).errorMessages,n=void 0===t?{}:t;if(!e)return n.emptyCardNumber||"Enter a card number";var a=e.replace(/\s/g,""),o=d(a);if(o&&o.lengths&&(o.lengths.includes(a.length)&&v(a)))return r?r({cardNumber:a,cardType:o,errorMessages:n}):void 0;return n.invalidCardNumber||"Card number is invalid"},g=function(e,r){var t=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).errorMessages,n=void 0===t?{}:t;if(!e)return n.emptyExpiryDate||"Enter an expiry date";var a=e.replace(" / ","").replace("/","");if(4===a.length){var o=a.slice(0,2),u="20".concat(a.slice(2,4));return f.test(o)?parseInt(u)<(new Date).getFullYear()?n.yearOutOfRange||"Expiry year cannot be in the past":parseInt(u)===(new Date).getFullYear()&&parseInt(o)<(new Date).getMonth()+1?n.dateOutOfRange||"Expiry date cannot be in the past":r?r({expiryDate:{month:o,year:u},errorMessages:n}):void 0:n.monthOutOfRange||"Expiry month must be between 01 and 12"}return n.invalidExpiryDate||"Expiry date is invalid"},y=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=t.cardType,a=t.errorMessages,o=void 0===a?{}:a;return e?e.length<3?o.invalidCVC||"CVC is invalid":n&&e.length!==n.code.length?o.invalidCVC||"CVC is invalid":r?r({cvc:e,cardType:n,errorMessages:o}):void 0:o.emptyCVC||"Enter a CVC"},m=function(e){var r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).errorMessages;if(!e)return(void 0===r?{}:r).emptyZIP||"Enter a ZIP code"},C={cardTypes:Object.freeze({DEFAULT_CVC_LENGTH:3,DEFAULT_ZIP_LENGTH:5,DEFAULT_CARD_FORMAT:l,CARD_TYPES:s,getCardTypeByValue:d,getCardTypeByType:function(e){return s.filter(function(r){return r.type===e})[0]}}),formatter:Object.freeze({formatCardNumber:function(e){var r=d(e);if(!r)return(e.match(/\d+/g)||[]).join("");var t=r.format;if(t&&t.global)return(e.match(t)||[]).join(" ");if(t){var n=t.exec(e.split(" ").join(""));if(n)return n.splice(1,3).filter(function(e){return e}).join(" ")}return e},formatExpiry:function(e){var r=e.nativeEvent&&e.nativeEvent.data,t=e.target.value.split(" / ").join("/");if(!t)return null;var n=t;if(/^[2-9]$/.test(n)&&(n="0".concat(n)),2===t.length&&+t>12){var a=u(t.split("")),i=a[0],c=a.slice(1);n="0".concat(i,"/").concat(c.join(""))}if(/^1[/-]$/.test(n))return"01 / ";if(1===(n=n.match(/(\d{1,2})/g)||[]).length){if(!r&&t.includes("/"))return n[0];if(/\d{2}/.test(n))return"".concat(n[0]," / ")}if(n.length>2){var l=o(n.join("").match(/^(\d{2}).*(\d{2})$/)||[],3),s=l[1],d=void 0===s?null:s,f=l[2];return[d,void 0===f?null:f].join(" / ")}return n.join(" / ")}}),validator:Object.freeze({EMPTY_CARD_NUMBER:"Enter a card number",EMPTY_EXPIRY_DATE:"Enter an expiry date",EMPTY_CVC:"Enter a CVC",EMPTY_ZIP:"Enter a ZIP code",INVALID_CARD_NUMBER:"Card number is invalid",INVALID_EXPIRY_DATE:"Expiry date is invalid",INVALID_CVC:"CVC is invalid",MONTH_OUT_OF_RANGE:"Expiry month must be between 01 and 12",YEAR_OUT_OF_RANGE:"Expiry year cannot be in the past",DATE_OUT_OF_RANGE:"Expiry date cannot be in the past",hasCardNumberReachedMaxLength:function(e){var r=d(e);return r&&e.length>=r.lengths[r.lengths.length-1]},isNumeric:function(e){return/^\d*$/.test(e.key)},validateLuhn:v,getCardNumberError:p,getExpiryDateError:g,getCVCError:y,getZIPError:m}),BACKSPACE_KEY_CODE:"Backspace",ENTER_KEY_CODE:"Enter",isHighlighted:function(){return"Range"===(window.getSelection()||{type:void 0}).type}};e.getCVCError=y,e.getCardNumberError=p,e.getExpiryDateError=g,e.getZIPError=m,e.usePaymentInputs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=e.autoFocus,i=void 0===u||u,c=e.errorMessages,l=e.onBlur,s=e.onChange,d=e.onError,f=e.onTouch,v=e.cardNumberValidator,p=e.cvcValidator,g=e.expiryValidator,y=r.useRef(),m=r.useRef(),h=r.useRef(),E=r.useRef(),b=o(r.useState({cardNumber:!1,expiryDate:!1,cvc:!1,zip:!1}),2),D=b[0],P=b[1],N=o(r.useState(!1),2),O=N[0],_=N[1],x=o(r.useState({cardNumber:void 0,expiryDate:void 0,cvc:void 0,zip:void 0}),2),T=x[0],K=x[1],V=o(r.useState(),2),k=V[0],M=V[1],A=o(r.useState(),2),I=A[0],R=A[1],w=o(r.useState(),2),j=w[0],B=w[1],F=r.useCallback(function(e,r){K(function(a){if(a[e]===r)return a;var o=r,u=n({},a,t({},e,r));return r?M(r):(o=Object.values(u).find(Boolean),M(o)),d&&d(o,u),u})},[]),Y=r.useCallback(function(e,r){requestAnimationFrame(function(){"INPUT"!==document.activeElement.tagName?_(!0):!1===r&&_(!1)}),P(function(a){if(a[e]===r)return a;var o=n({},a,t({},e,r));return f&&f(t({},e,r),o),o})},[]),S=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){e.onBlur&&e.onBlur(r),l&&l(r),B(void 0),Y("cardNumber",!0)}},[l,Y]),L=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){var t=(r.target.value||"").replace(/\s/g,""),n=y.current.selectionStart,a=C.cardTypes.getCardTypeByValue(t);R(a),Y("cardNumber",!1),y.current.value=C.formatter.formatCardNumber(t),e.onChange&&e.onChange(r),s&&s(r),requestAnimationFrame(function(){document.activeElement===y.current&&(" "===y.current.value[n-1]&&(n+=1),y.current.setSelectionRange(n,n))});var o=C.validator.getCardNumberError(t,v,{errorMessages:c});!o&&i&&m.current&&m.current.focus(),F("cardNumber",o),e.onError&&e.onError(o)}},[i,v,c,s,F,Y]),z=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){e.onFocus&&e.onFocus(r),B("cardNumber")}},[]),Z=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){var t=(r.target.value||"").replace(/\s/g,"");e.onKeyPress&&e.onKeyPress(r),r.key!==C.ENTER_KEY_CODE&&(C.validator.isNumeric(r)||r.preventDefault(),C.validator.hasCardNumberReachedMaxLength(t)&&r.preventDefault())}},[]),U=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.refKey,o=a(e,["refKey"]);return n(t({"aria-label":"Card number",autoComplete:"cc-number",id:"cardNumber",name:"cardNumber",placeholder:"Card number",type:"tel"},r||"ref",y),o,{onBlur:S(o),onChange:L(o),onFocus:z(o),onKeyPress:Z(o)})},[S,L,z,Z]),G=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){e.onBlur&&e.onBlur(r),l&&l(r),B(void 0),Y("expiryDate",!0)}},[l,Y]),H=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){Y("expiryDate",!1),m.current.value=C.formatter.formatExpiry(r),e.onChange&&e.onChange(r),s&&s(r);var t=C.validator.getExpiryDateError(m.current.value,g,{errorMessages:c});!t&&i&&h.current&&h.current.focus(),F("expiryDate",t),e.onError&&e.onError(t)}},[i,c,g,s,F,Y]),$=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){e.onFocus&&e.onFocus(r),B("expiryDate")}},[]),q=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){e.onKeyDown&&e.onKeyDown(r),r.key===C.BACKSPACE_KEY_CODE&&!r.target.value&&i&&y.current&&y.current.focus()}},[i]),X=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){var t=(r.target.value||"").replace(" / ","");e.onKeyPress&&e.onKeyPress(r),r.key!==C.ENTER_KEY_CODE&&(C.validator.isNumeric(r)||r.preventDefault(),t.length>=4&&r.preventDefault())}},[]),J=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.refKey,o=a(e,["refKey"]);return n(t({"aria-label":"Expiry date in format MM YY",autoComplete:"cc-exp",id:"expiryDate",name:"expiryDate",placeholder:"MM/YY",type:"tel"},r||"ref",m),o,{onBlur:G(o),onChange:H(o),onFocus:$(o),onKeyDown:q(o),onKeyPress:X(o)})},[G,H,$,q,X]),Q=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){e.onBlur&&e.onBlur(r),l&&l(r),B(void 0),Y("cvc",!0)}},[l,Y]),W=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).cardType;return function(t){var n=t.target.value;Y("cvc",!1),e.onChange&&e.onChange(t),s&&s(t);var a=C.validator.getCVCError(n,p,{cardType:r,errorMessages:c});!a&&i&&E.current&&E.current.focus(),F("cvc",a),e.onError&&e.onError(a)}},[i,p,c,s,F,Y]),ee=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){e.onFocus&&e.onFocus(r),B("cvc")}},[]),re=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){e.onKeyDown&&e.onKeyDown(r),r.key===C.BACKSPACE_KEY_CODE&&!r.target.value&&i&&m.current&&m.current.focus()}},[i]),te=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(arguments.length>1?arguments[1]:void 0).cardType;return function(t){var n=(t.target.value||"").replace(" / ","");e.onKeyPress&&e.onKeyPress(t),t.key!==C.ENTER_KEY_CODE&&(C.validator.isNumeric(t)||t.preventDefault(),r&&n.length>=r.code.length&&t.preventDefault(),n.length>=4&&t.preventDefault())}},[]),ne=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.refKey,o=a(e,["refKey"]);return n(t({"aria-label":"CVC",autoComplete:"cc-csc",id:"cvc",name:"cvc",placeholder:I?I.code.name:"CVC",type:"tel"},r||"ref",h),o,{onBlur:Q(o),onChange:W(o,{cardType:I}),onFocus:ee(o),onKeyDown:re(o),onKeyPress:te(o,{cardType:I})})},[I,Q,W,ee,re,te]),ae=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){e.onBlur&&e.onBlur(r),l&&l(r),B(void 0),Y("zip",!0)}},[l,Y]),oe=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){var t=r.target.value;Y("zip",!1),e.onChange&&e.onChange(r),s&&s(r);var n=C.validator.getZIPError(t,{errorMessages:c});F("zip",n),e.onError&&e.onError(n)}},[c,s,F,Y]),ue=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){e.onFocus&&e.onFocus(r),B("zip")}},[]),ie=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){e.onKeyDown&&e.onKeyDown(r),r.key===C.BACKSPACE_KEY_CODE&&!r.target.value&&i&&h.current&&h.current.focus()}},[i]),ce=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){e.onKeyPress&&e.onKeyPress(r),r.key!==C.ENTER_KEY_CODE&&(C.validator.isNumeric(r)||r.preventDefault())}},[]),le=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.refKey,o=a(e,["refKey"]);return n(t({autoComplete:"off",id:"zip",maxLength:"6",name:"zip",placeholder:"ZIP",type:"tel"},r||"ref",E),o,{onBlur:ae(o),onChange:oe(o),onFocus:ue(o),onKeyDown:ie(o),onKeyPress:ce(o)})},[ae,oe,ue,ie,ce]),se=r.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.images||{};return n({"aria-label":I?I.displayName:"Placeholder card",children:r[I?I.type:"placeholder"]||r.placeholder,width:"1.5em",height:"1em",viewBox:"0 0 24 16"},e)},[I]);return r.useLayoutEffect(function(){if(E.current){var e=C.validator.getZIPError(E.current.value,{errorMessages:c});F("zip",e)}if(h.current){var r=C.validator.getCVCError(h.current.value,p,{errorMessages:c});F("cvc",r)}if(m.current){var t=C.validator.getExpiryDateError(m.current.value,g,{errorMessages:c});F("expiryDate",t)}if(y.current){var n=C.validator.getCardNumberError(y.current.value,v,{errorMessages:c});F("cardNumber",n)}},[v,p,c,g,F]),r.useLayoutEffect(function(){y.current&&(y.current.value=C.formatter.formatCardNumber(y.current.value)),m.current&&(m.current.value=C.formatter.formatExpiry({target:m.current}))},[]),r.useLayoutEffect(function(){if(y.current){var e=C.cardTypes.getCardTypeByValue(y.current.value);R(e)}},[]),{getCardImageProps:se,getCardNumberProps:U,getExpiryDateProps:J,getCVCProps:ne,getZIPProps:le,wrapperProps:{error:k,focused:j,isTouched:O},meta:{cardType:I,erroredInputs:T,error:k,focused:j,isTouched:O,touchedInputs:D}}},Object.defineProperty(e,"__esModule",{value:!0})});
